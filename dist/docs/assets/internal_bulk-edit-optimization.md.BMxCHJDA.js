import{_ as e,c as r,o as d,ag as o}from"./chunks/framework.CffQSbY-.js";const m=JSON.parse('{"title":"Bulk Edit Optimization","description":"","frontmatter":{},"headers":[],"relativePath":"internal/bulk-edit-optimization.md","filePath":"internal/bulk-edit-optimization.md","lastUpdated":1767131782000}'),a={name:"internal/bulk-edit-optimization.md"};function i(n,t,l,s,c,p){return d(),r("div",null,[...t[0]||(t[0]=[o('<h1 id="bulk-edit-optimization" tabindex="-1">Bulk Edit Optimization <a class="header-anchor" href="#bulk-edit-optimization" aria-label="Permalink to &quot;Bulk Edit Optimization&quot;">​</a></h1><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">​</a></h2><p>Batch operations (multi-cursor, toggle comment, indent, replace-all) previously used <code>Event::Batch</code> which applied edits sequentially, causing O(n²) performance.</p><p>The <code>BulkEdit</code> event type solves this by:</p><ol><li>Applying all edits in a single tree traversal via <code>PieceTree::apply_bulk_edits</code></li><li>Storing tree snapshot for O(1) undo (Arc clone, not content copy)</li><li>Tracking cursor positions before/after for proper undo/redo</li></ol><h2 id="performance" tabindex="-1">Performance <a class="header-anchor" href="#performance" aria-label="Permalink to &quot;Performance&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Metric</th><th>Before (Batch)</th><th>After (BulkEdit)</th></tr></thead><tbody><tr><td>Tree traversals</td><td>O(N)</td><td>O(1)</td></tr><tr><td>Tree rebuilds</td><td>O(N)</td><td>O(1)</td></tr><tr><td>Memory for undo</td><td>O(N) event objects</td><td>O(1) Arc clone</td></tr><tr><td>Time complexity</td><td>O(N × pieces)</td><td>O(pieces + N)</td></tr></tbody></table><p>For 500 cursors: ~500x improvement.</p><h2 id="migration-status" tabindex="-1">Migration Status <a class="header-anchor" href="#migration-status" aria-label="Permalink to &quot;Migration Status&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Operation</th><th>Status</th><th>Location</th></tr></thead><tbody><tr><td>Multi-cursor edits</td><td>✅ Done</td><td><code>src/app/mod.rs</code></td></tr><tr><td>Replace All</td><td>✅ Done</td><td><code>src/app/render.rs</code> (ReplaceAll event removed)</td></tr><tr><td>Toggle Comment</td><td>✅ Done</td><td><code>src/app/render.rs</code></td></tr><tr><td>Indent/Dedent</td><td>✅ Done</td><td><code>src/app/mod.rs</code></td></tr><tr><td>LSP Rename</td><td>✅ Done</td><td><code>src/app/lsp_requests.rs</code></td></tr><tr><td>Multi-cursor Paste</td><td>✅ Done</td><td><code>src/app/clipboard.rs</code></td></tr></tbody></table><h2 id="key-functions" tabindex="-1">Key Functions <a class="header-anchor" href="#key-functions" aria-label="Permalink to &quot;Key Functions&quot;">​</a></h2><ul><li><code>PieceTree::apply_bulk_edits()</code> - Apply multiple edits in single traversal</li><li><code>Editor::apply_events_as_bulk_edit()</code> - Convert Insert/Delete events to BulkEdit</li><li><code>Event::BulkEdit</code> - Stores old_tree, old_cursors, new_cursors for undo/redo</li></ul>',12)])])}const h=e(a,[["render",i]]);export{m as __pageData,h as default};
